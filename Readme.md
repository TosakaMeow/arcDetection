## 基于STFT与DNN的电流异常检测

### 一、开发环境
    OS：Windows 11 Pro for Workstations
    Python版本：3.7
    CUDA版本：10.2、11.0
    TensorFlow版本：2.4.2
    Keras版本：2.4.3

### 二、文件介绍
### （1）train.py
    用于构建、训练神经网络的文件。
### （2）pretreat.py
    主要用于对数据进行预处理，将原始的时间序列数据转换为具有23个特征的
    新数据集作为训练集和测试集。
### （4）predict.py
    这个文件主要进行验证集或者新数据集的预测。
### （5）其他文件
    data_train.csv为训练集
    data_test.csv为测试集
    *.h5为保存的神经网络模型
    kwargs.py保存了整个项目的参数
    ......
### 三、流程介绍
### 1.获取训练集
    通过MATLAB对采集卡采集保存的mat文件进行特征提取，提取保存之后的文件保存在source_data目录下，
    在通过pretreat.py执行完毕后，会将所有的特征进行二次处理并进行离散特征的提取，处理完毕后的结果
    会对应放在temp文件夹下，处理的基本思路为设置一个窗口，长度为100，将时域、低频、高频的特征量进行
    累加，同时对低频和高频特征量进行离散统计，统计其位于10个等宽值域的数量，该宽度值为0.1，总的值域
    为[0.0, 1.0]。最后需要手动将temp中的文件进行合并，arc_temp.xls与normal_temp.xls进行合并，作
    为训练集，其余两个文件进行合并作为验证集。在手动合并的时候需要添加head，分别为：
    area,low,high,f1,f2,f3,f4,f5,f6,f7,f8,f9,f10,f11,f12,f13,f14,f15,f16,f17,f18,f19,f20,label
    最后一列为手动标签，注意伪标签的影响，同时确保arc数据与normal数据量大致相等。
### 2.模型构建
    模型采用融合模型的策略，其中时域、低频、高频特征量作为连续特征量需要引入到卷积神经网络，其余离散特征
    需要引入到普通的全连接神经网络，具体模型定义请参考代码。
    模型的最终输出为sigmoid，概率最大者为确定结果。